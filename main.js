(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};function e(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.classList.remove(n),e.removeAttribute("disabled")):(e.classList.add(n),e.setAttribute("disabled",""))}t.d({},{v:()=>$,f:()=>w});var n=document.querySelector("#nameEditPopup"),o=document.querySelector("#addPhotoPopup"),r=document.querySelector(".profile__name-edit-button"),c=document.querySelector(".profile__add-button"),a=document.querySelector("#nameEditForm"),u=a.querySelector("#usernameInput"),i=a.querySelector("#userJobInput"),l=document.querySelector(".profile__name"),s=document.querySelector(".profile__description"),d=document.querySelector("#photoAddForm"),p=document.querySelector("#photoTitle"),f=document.querySelector("#photoLink"),m=document.querySelector(".elements__container"),h=document.querySelector(".card-template").content,v=document.querySelector("#bigImgPopup"),y=document.querySelector(".popup__image"),_=document.querySelector(".popup__image-name"),b=Array.from(document.querySelectorAll(".popup")),S=document.querySelector("#photoSubmitBtn"),q=document.querySelector(".profile__avatar-wrapper"),E=document.querySelector(".profile__avatar-overlay"),L=document.querySelector(".profile__avatar-edit-button"),g=document.querySelector("#avatarEditPopup"),k=document.querySelector("#avatarInput"),C=document.querySelector("#avatarEditForm"),A=document.querySelector(".profile__avatar");function x(t){t.classList.remove("popup_opened"),document.removeEventListener("keydown",O)}function P(t){t.classList.add("popup_opened"),document.addEventListener("keydown",O)}function T(t,e,n){t.querySelector(e).textContent=n?"Сохранение...":"Сохранить"}var w,z={baseUrl:"https://nomoreparties.co/v1/plus-cohort-20",headers:{authorization:"340a2beb-4d1b-4011-9455-07dbc10b8c56","Content-Type":"application/json"}},B=function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))};function U(){return fetch("".concat(z.baseUrl,"/cards"),{method:"GET",headers:z.headers}).then((function(t){return B(t)}))}function j(t,e,n,o,r){var c=h.cloneNode(!0),a=c.querySelector(".card__image"),u=c.querySelector(".card__title"),i=c.querySelector(".card__button-like"),l=c.querySelector(".card__button-delete"),s=c.querySelector(".card__like-number");return a.src=t,u.textContent=e,a.alt=e,s.textContent=n.length,i.addEventListener("click",(function(t){t.target.classList.contains("card__button-like_active")?function(t){return fetch("".concat(z.baseUrl,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:z.headers.authorization}}).then((function(t){return B(t)}))}(r).then((function(e){s.textContent=e.likes.length,t.target.classList.remove("card__button-like_active")})).catch((function(t){console.log(t)})):function(t){return fetch("".concat(z.baseUrl,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:z.headers.authorization}}).then((function(t){return B(t)}))}(r).then((function(e){s.textContent=e.likes.length,t.target.classList.add("card__button-like_active")})).catch((function(t){console.log(t)}))})),n.forEach((function(t){t._id===w&&i.classList.add("card__button-like_active")})),l.addEventListener("click",(function(t){(function(t){return fetch("".concat(z.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:{authorization:z.headers.authorization}}).then((function(t){return B(t)}))})(r).then((function(){t.target.closest(".card").remove(c)})).catch((function(t){console.log(t)}))})),o!==w&&l.classList.add("card__button-delete_disabled"),a.addEventListener("click",(function(){y.src=t,y.alt=e,_.textContent=e,P(v)})),c}function O(t){"Escape"===t.key&&x(document.querySelector(".popup_opened"))}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var J,N,D,F,G,H,M,$={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};U().then((function(t){console.log(t)})).catch((function(t){console.log(t)})),Promise.all([fetch("".concat(z.baseUrl,"/users/me"),{method:"GET",headers:{authorization:z.headers.authorization}}).then((function(t){return B(t)})),U()]).then((function(t){var e,n,o=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,c=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(c.push(o.value),!e||c.length!==e);a=!0);}catch(t){u=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw r}}return c}}(e,n)||function(t,e){if(t){if("string"==typeof t)return I(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],c=o[1];l.textContent=r.name,s.textContent=r.about,A.src=r.avatar,w=r._id,c.forEach((function(t){m.prepend(j(t.link,t.name,t.likes,t.owner._id,t._id))}))})).catch((function(t){console.log(t)})),q.addEventListener("mouseover",(function(){E.style.visibility="visible",E.style.opacity="1"})),q.addEventListener("mouseout",(function(){E.style.visibility="hidden",E.style.opacity="0"})),L.addEventListener("click",(function(){C.reset(),T(C,$.submitButtonSelector,!1),P(g)})),r.addEventListener("click",(function(){a.reset(),u.value=l.textContent,i.value=s.textContent,T(a,$.submitButtonSelector,!1),P(n)})),c.addEventListener("click",(function(){d.reset(),S.setAttribute("disabled",!0),S.classList.add("popup__button_disabled"),T(o,$.submitButtonSelector,!1),P(o)})),C.addEventListener("submit",(function(){return T(C,$.submitButtonSelector,!0),(t=k.value,fetch("".concat(z.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:z.headers,body:JSON.stringify({avatar:t})}).then((function(t){return B(t)}))).then((function(t){A.src=t.avatar,x(g)})).catch((function(t){console.log(t)}));var t})),a.addEventListener("submit",(function(){return T(a,$.submitButtonSelector,!0),(t=u.value,e=i.value,fetch("".concat(z.baseUrl,"/users/me"),{method:"PATCH",headers:z.headers,body:JSON.stringify({name:t,about:e})}).then((function(t){return B(t)}))).then((function(t){l.textContent=t.name,s.textContent=t.about,x(n)})).catch((function(t){console.log(t)}));var t,e})),d.addEventListener("submit",(function(){return T(d,$.submitButtonSelector,!0),(t=p.value,e=f.value,fetch("".concat(z.baseUrl,"/cards"),{method:"POST",headers:{authorization:z.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:e})}).then((function(t){return B(t)}))).then((function(t){m.prepend(j(t.link,t.name,t.likes,t.owner._id,t._id)),x(o)})).catch((function(t){console.log(t)}));var t,e})),b.forEach((function(t){t.addEventListener("mousedown",(function(e){e.target.classList.contains("popup_opened")&&x(t),e.target.classList.contains("popup__close-btn")&&x(t)}))})),N=(J=$).formSelector,D=J.inputSelector,F=J.submitButtonSelector,G=J.inactiveButtonClass,H=J.inputErrorClass,M=J.errorClass,document.querySelectorAll(N).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),function(t,n,o,r,c,a){var u=Array.from(t.querySelectorAll(n)),i=t.querySelector(o);e(u,i,r),u.forEach((function(n){n.addEventListener("input",(function(){!function(t,e,n,o){e.validity.valid?function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n),r.classList.remove(o),r.textContent=""}(t,e,n,o):function(t,e,n,o,r){var c=t.querySelector(".".concat(e.id,"-error"));e.classList.add(o),c.classList.add(r),c.textContent=n}(t,e,e.validationMessage,n,o)}(t,n,c,a),e(u,i,r)}))}))}(t,D,F,G,H,M)}))})();